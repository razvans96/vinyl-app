"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[28],{28:(J,d,r)=>{r.r(d),r.d(d,{HomePageModule:()=>O});var l=r(4755),i=r(712),u=r(5030),_=r(4546),g=r(237),m=r(5861),f=r(6090),Z=r(7423),t=r(3020),T=r(5830),p=r(7556);function S(n,s){if(1&n&&(t.TgZ(0,"label"),t._uU(1),t.qZA()),2&n){const o=t.oxw();t.xp6(1),t.Oqu(o.user)}}function b(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-button",8),t.NdJ("click",function(){t.CHM(o);const c=t.oxw();return t.KtG(c.goToLogin())}),t._UZ(1,"ion-icon",9),t._uU(2," Login "),t.qZA()}}function y(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-button",8),t.NdJ("click",function(){t.CHM(o);const c=t.oxw();return t.KtG(c.logOut())}),t._UZ(1,"ion-icon",10),t._uU(2," Logout "),t.qZA()}}function A(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-button",11),t.NdJ("click",function(){t.CHM(o);const c=t.oxw();return t.KtG(c.goToRegister())}),t._uU(1," Register "),t.qZA()}}let x=(()=>{class n{constructor(o,e){this.router=o,this.authService=e,this.user=""}ngOnInit(){this.getUser()}ionViewWillEnter(){this.getUser()}getUser(){this.user=this.authService.getUser(),console.log("USUARIO:"+this.user)}goToLogin(){this.router.navigate(["/login"])}goToRegister(){this.router.navigate(["/register"])}isLoggedIn(){return this.authService.isLoggedIn()}logOut(){localStorage.removeItem("token"),window.location.reload()}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(g.F0),t.Y36(p.e))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-header"]],decls:11,vars:5,consts:[[1,"ion-no-border",3,"translucent"],["slot","start"],[1,"logo-avatar"],["src","https://static.vecteezy.com/system/resources/previews/004/820/423/original/vinyl-recorder-with-sound-wave-effect-inside-free-vector.jpg"],["slot","end"],[4,"ngIf"],[3,"click",4,"ngIf"],["fill","outline",3,"click",4,"ngIf"],[3,"click"],["slot","start","name","person-outline"],["slot","start","name","person-circle-outline"],["fill","outline",3,"click"]],template:function(o,e){1&o&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button")(4,"ion-avatar",2),t._UZ(5,"img",3),t.qZA()()(),t.TgZ(6,"ion-buttons",4),t.YNc(7,S,2,1,"label",5),t.YNc(8,b,3,0,"ion-button",6),t.YNc(9,y,3,0,"ion-button",6),t.YNc(10,A,2,0,"ion-button",7),t.qZA()()()),2&o&&(t.Q6J("translucent",!0),t.xp6(7),t.Q6J("ngIf",e.isLoggedIn()),t.xp6(1),t.Q6J("ngIf",!e.isLoggedIn()),t.xp6(1),t.Q6J("ngIf",e.isLoggedIn()),t.xp6(1),t.Q6J("ngIf",!e.isLoggedIn()))},dependencies:[l.O5,i.BJ,i.YG,i.Sm,i.Gu,i.gu,i.sr]}),n})();function C(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-item")(1,"ion-thumbnail",12),t._UZ(2,"img",13),t.qZA(),t.TgZ(3,"ion-label")(4,"h2"),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.ALo(10,"date"),t.qZA()(),t.TgZ(11,"ion-button",14),t.NdJ("click",function(){const a=t.CHM(o).$implicit,h=t.oxw();return t.KtG(h.goToSongDetails(a._id))}),t._UZ(12,"ion-icon",15),t.qZA()()}if(2&n){const o=s.$implicit;t.xp6(2),t.Q6J("src",o.photo?o.photo:o.photobase64,t.LSH),t.xp6(3),t.Oqu(o.title),t.xp6(2),t.Oqu(o.artist),t.xp6(2),t.Oqu(t.lcZ(10,4,o.date))}}function v(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-button",16),t.NdJ("click",function(){t.CHM(o);const c=t.oxw();return t.KtG(c.goToAddSong())}),t._UZ(1,"ion-icon",17),t.qZA()}}function H(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-item")(1,"ion-thumbnail",12),t._UZ(2,"img",13),t.qZA(),t.TgZ(3,"ion-label")(4,"h2"),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.ALo(10,"date"),t.qZA()(),t.TgZ(11,"ion-button",14),t.NdJ("click",function(){const a=t.CHM(o).$implicit,h=t.oxw(2);return t.KtG(h.addSong(a))}),t._uU(12,"Add"),t.qZA()()}if(2&n){const o=s.$implicit;t.xp6(2),t.Q6J("src",o.photo,t.LSH),t.xp6(3),t.Oqu(o.title),t.xp6(2),t.Oqu(o.artist),t.xp6(2),t.Oqu(t.lcZ(10,4,o.date))}}function P(n,s){if(1&n&&(t.TgZ(0,"ion-list")(1,"h3")(2,"strong"),t._uU(3,"Maybe you want to check this Spotify songs"),t.qZA()(),t.YNc(4,H,13,6,"ion-item",8),t.qZA()),2&n){const o=t.oxw();t.xp6(4),t.Q6J("ngForOf",o.spotifySongs)}}const M=[{path:"",component:(()=>{class n{constructor(o,e,c){this.apiService=o,this.authService=e,this.router=c,this.songs=[],this.spotifySongs=[],this.searchTitle="",this.searchArtist="",this.searchDate="",this.searchExec=!1,this.showSpotify=!1}ngOnInit(){this.getAllSongs()}ionViewWillEnter(){this.getLocation(),this.cleanFilters(),this.searchExec=!1,this.showSpotify=!1}getAllSongs(){this.apiService.getSongs().then(o=>{this.songs=o,console.log(this.songs)})}convertFromBase64(o){return fetch(o).then(e=>e.blob()).catch(e=>(console.error("Error converting from base64:",e),Promise.reject(e)))}search(){this.searchSongs(),this.searchExec=!0,this.checkSpotifySearch(),this.showSpotify&&this.searchSpotifySongs()}checkSpotifySearch(){this.showSpotify=!(!this.isLoggedIn()||!this.searchExec)}searchSongs(){let o="?";""!=this.searchTitle&&(o+=`title=${this.searchTitle}&`),""!=this.searchArtist&&(o+=`artist=${this.searchArtist}&`),""!=this.searchDate&&(o+=`date=${this.searchDate}&`),console.log(o),this.apiService.searchSongs(o).then(e=>{this.songs=e,console.log(this.songs)})}searchSpotifySongs(){let o="?q=";""!=this.searchTitle&&(o+=`track:${this.searchTitle} `),""!=this.searchArtist&&(o+=`artist:${this.searchArtist} `),""!=this.searchDate&&(o+=`year:${this.searchDate.substring(0,4)} `),console.log(o),this.apiService.searchSpotifySongs(o).then(e=>{this.spotifySongs=e,console.log(this.spotifySongs)})}cleanFilters(){this.searchTitle="",this.searchArtist="",this.searchDate="",this.searchExec=!1,this.showSpotify=!1,this.getAllSongs()}isLoggedIn(){return this.authService.isLoggedIn()}goToAddSong(){this.router.navigate(["/add-song"])}goToSongDetails(o){this.router.navigate([`/song/${o}`])}addSong(o){console.log("New song:",o),o.user=this.authService.getUserId(),o.location=Object.create(null),o.location.latitude=this.latitude,o.location.longitude=this.longitude,o.location.accuracy=this.accuracy,this.apiService.postSong(o).then(e=>{console.log("New song",e),this.search()})}getLocation(){var o=this;return(0,m.Z)(function*(){if(Z.dV.isNativePlatform()){const e=yield f.b.getCurrentPosition();o.latitude=e.coords.latitude,o.longitude=e.coords.longitude,o.accuracy=e.coords.accuracy,console.log("Current position:",o.latitude,o.longitude,o.accuracy)}else navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{o.latitude=e.coords.latitude,o.longitude=e.coords.longitude,o.accuracy=e.coords.accuracy,console.log("Current position:",o.latitude,o.longitude,o.accuracy)},e=>{console.log("Error getting location:",e)}):console.log("Geolocation is not supported by this browser.")})()}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(T.s),t.Y36(p.e),t.Y36(g.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-home"]],decls:33,vars:6,consts:[["size-md","8","offset-md","2"],["position","floating"],[3,"ngModel","ngModelChange"],["placeholder","","type","date",3,"ngModel","ngModelChange"],["size-xs","12","size-md","2"],["expand","full",3,"click"],["slot","start","name","search-sharp"],["slot","start","name","refresh-sharp"],[4,"ngFor","ngForOf"],["size-xs","12","size-md","4","offset-md","6"],["position","floating",3,"click",4,"ngIf"],[4,"ngIf"],["slot","start"],["alt","Song Photo",3,"src"],["slot","end",3,"click"],["name","chevron-forward-sharp"],["position","floating",3,"click"],["shape","round","name","add-sharp"]],template:function(o,e){1&o&&(t._UZ(0,"app-header"),t.TgZ(1,"ion-content")(2,"ion-row")(3,"ion-col",0)(4,"ion-grid")(5,"ion-row")(6,"ion-col")(7,"ion-item")(8,"ion-label",1),t._uU(9,"Search by title"),t.qZA(),t.TgZ(10,"ion-input",2),t.NdJ("ngModelChange",function(a){return e.searchTitle=a}),t.qZA()()(),t.TgZ(11,"ion-col")(12,"ion-item")(13,"ion-label",1),t._uU(14,"Search by artist"),t.qZA(),t.TgZ(15,"ion-input",2),t.NdJ("ngModelChange",function(a){return e.searchArtist=a}),t.qZA()()(),t.TgZ(16,"ion-col")(17,"ion-item")(18,"ion-label",1),t._uU(19,"Search by date"),t.qZA(),t.TgZ(20,"ion-input",3),t.NdJ("ngModelChange",function(a){return e.searchDate=a}),t.qZA()()()(),t.TgZ(21,"ion-row")(22,"ion-col",4)(23,"ion-button",5),t.NdJ("click",function(){return e.search()}),t._UZ(24,"ion-icon",6),t.qZA()(),t.TgZ(25,"ion-col",4)(26,"ion-button",5),t.NdJ("click",function(){return e.cleanFilters()}),t._UZ(27,"ion-icon",7),t.qZA()()()(),t.TgZ(28,"ion-list"),t.YNc(29,C,13,6,"ion-item",8),t.TgZ(30,"ion-col",9),t.YNc(31,v,2,0,"ion-button",10),t.qZA()(),t.YNc(32,P,5,1,"ion-list",11),t.qZA()()()),2&o&&(t.xp6(10),t.Q6J("ngModel",e.searchTitle),t.xp6(5),t.Q6J("ngModel",e.searchArtist),t.xp6(5),t.Q6J("ngModel",e.searchDate),t.xp6(9),t.Q6J("ngForOf",e.songs),t.xp6(2),t.Q6J("ngIf",e.isLoggedIn()),t.xp6(1),t.Q6J("ngIf",e.showSpotify))},dependencies:[l.sg,l.O5,u.JJ,u.On,i.YG,i.wI,i.W2,i.jY,i.gu,i.pK,i.Ie,i.Q$,i.q_,i.Nd,i.Bs,i.j9,x,l.uU],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color: #f4f4f4}ion-searchbar[_ngcontent-%COMP%]{margin:10px}ion-item[_ngcontent-%COMP%]{padding:10px}ion-item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:60px;height:60px}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:700}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#888;margin-top:5px}"]}),n})()}];let U=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.Bz.forChild(M),g.Bz]}),n})(),O=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[l.ez,u.u5,i.Pc,U,_.O]}),n})()}}]);